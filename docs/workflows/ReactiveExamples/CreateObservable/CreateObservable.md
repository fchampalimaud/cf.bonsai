# CreateObservable

## Summary
This example demonstrates how the behavior of the [*CreateObservable*](https://bonsai-rx.org/docs/api/Bonsai.Reactive.CreateObservable.html) node is modified when subscribed by the high-level operators [*Merge*](https://bonsai-rx.org/docs/api/Bonsai.Reactive.Merge.html), [*Concat*](https://bonsai-rx.org/docs/api/Bonsai.Reactive.Concat.html), or [*Switch*](https://bonsai-rx.org/docs/api/Bonsai.Reactive.Switch.html) nodes

## Workflow

:::workflow
![Example](~/workflows/ReactiveExamples/CreateObservable/CreateObservable.bonsai)
:::


## Details
The behavior of the *CreateObservable* node is a bit special, in the sense that it needs to be subscribed by a subsequent higher-level operator in order to run its internal workflow. In this example, the workflow under the *CreateObservable* nodes is the same for the three branches, and every instance of the *CreateObservable* generates a counter (*Timer*) that starts at 0 and terminates at 4 (*Take*), when it stops and closes the sequence (see workflow below). In this example, we show three ways in which the node can be subscribed, and how each way changes the subscription schedule. 

1. Generates a notification whenever the 'A' key is pressed and passes it to *MySubject*.
2. Initiates a counter asynchronously everytime *MySubject* gets a notification. The counter is subscribed by a *Merge* node.
3. Initiates a counter asynchronously everytime *MySubject* gets a notification. The counter is subscribed by a *Concat* node.
4. Initiates a counter asynchronously everytime *MySubject* gets a notification. The counter is subscribed by a *Switch* node.

*CreateObservable*
:::workflow
![Example](~/workflows/ReactiveExamples/CreateObservable/CreateObservableInnerWorkflow.bonsai)
:::



## Visualization
Visualize the *Merge*, *Concat* and *Switch* nodes using the TimeSeriesVisualizer and their behavior whenever 'A' is pressed. 

You will see that if you only press the key once in every 5 seconds, the nodes behave the same. This is because each branch will have only one active instance of *CreateObservable* running. 

However, if you press 'A' twice within a ~2 seconds interval, you will generate two active instances of *CreateObservable*, in each branch, running asynchronously from each other. This will produce very different results when followed by *Merge*, *Concat* and *Switch*: 
1. The *Merge* node will output the latest value generated by either concurrent instances of *CreateObservable*. In doing this, the pair of nodes *CreateObservable* and *Merge* will behave similarly to a [*SelectMany*](https://bonsai-rx.org/docs/api/Bonsai.Reactive.SelectMany.html) node, which is implicitly followed by a *Merge* operation.
2. The *Concat* node will only generate values from the second instance, only after first one has terminated, i.e. it will show first the five values generated by the first counter, followed by the five values generated by the second.
3. The *Switch* node will show the values of the first counter only until the second starts. Once this happens the first counter is closed and only the second one will normally produce its notifications.


**Note:** To verify that the inner workflow of the *CreateObservable* does not run without a subsequent subscription by either of the three higher-level operators, you can remove one of this operators from one of the branches, go inside the *CreateObservable* workflow, and visualize the notifications generated by the *Timer* node when your program is running. If you do this, you will see that no element will be generated in response to an 'A' key press.